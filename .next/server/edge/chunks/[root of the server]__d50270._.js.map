{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/src/middleware.ts"],"sourcesContent":["import { jwtVerify } from \"jose\"; // jose is Edge-runtime compatible\r\nimport { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\n// Helper function to verify the token using jose\r\nasync function verifyToken(token: string, secret: string) {\r\n  try {\r\n    const { payload } = await jwtVerify(token, new TextEncoder().encode(secret));\r\n    return payload;\r\n  } catch (error) {\r\n    console.error(\"JWT verification failed:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function middleware(request: NextRequest) {\r\n  const isAdminRoute = request.nextUrl.pathname.startsWith(\"/admin/\");\r\n  const secret = process.env.NEXT_PUBLIC_JWT_SECRET;\r\n\r\n  if (isAdminRoute && secret) {\r\n    const token = request.cookies.get(\"token\");\r\n    if (!token) return NextResponse.redirect(new URL(\"/\", request.url));\r\n    const payload = await verifyToken(token.value, secret);\r\n\r\n    if (!payload) {\r\n      return NextResponse.redirect(new URL(\"/\", request.url));\r\n    }\r\n  }\r\n  return NextResponse.next();\r\n}\r\n"],"names":[],"mappings":";;;AACA;AADA,yQAAkC,kCAAkC;AACpE;;;AAGA,iDAAiD;AACjD,eAAe,YAAY,KAAa,EAAE,MAAc;IACtD,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,wJAAA,CAAA,YAAS,AAAD,EAAE,OAAO,IAAI,cAAc,MAAM,CAAC;QACpE,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;IACT;AACF;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,eAAe,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IACzD,MAAM;IAEN,IAAI,gBAAgB,QAAQ;QAC1B,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC;QAClC,IAAI,CAAC,OAAO,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACjE,MAAM,UAAU,MAAM,YAAY,MAAM,KAAK,EAAE;QAE/C,IAAI,CAAC,SAAS;YACZ,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACvD;IACF;IACA,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;AAC1B"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}